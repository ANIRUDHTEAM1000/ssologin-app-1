{"ast":null,"code":"import _regeneratorRuntime from\"/Users/g.anirudh/Desktop/POC/food-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/g.anirudh/Desktop/POC/food-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/g.anirudh/Desktop/POC/food-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'./App.css';import{useEffect,useState}from\"react\";import{useParams}from\"react-router-dom\";import axios from\"axios\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";function App(){var _useParams=useParams(),id=_useParams.id;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];var limit=3;if(localStorage.getItem(\"count\")===null){localStorage.setItem(\"count\",'0');}// getStaus function returns promise with true or false based on page up\nfunction getStatus(_x){return _getStatus.apply(this,arguments);}// function to redirect\nfunction _getStatus(){_getStatus=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(url){var a;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get(url).then(function(response){if(response.status===200){return true;}else{return false;}}).then(function(data){return data;}).catch(function(error){return false;});case 2:a=_context2.sent;return _context2.abrupt(\"return\",a);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return _getStatus.apply(this,arguments);}var redirect=function redirect(url){window.location.replace(url);};// UseEffect Function\nuseEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var isUp;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(typeof id!=='undefined'&&id!==null&&id!==\"\")){_context.next=8;break;}document.cookie=id;setToken(id);console.log(token);localStorage.setItem(\"count\",\"\".concat(0));console.log(window.location.host);// redirect(`https://${window.location.host}/success`)\n_context.next=17;break;case 8:if(!(parseInt(localStorage.getItem(\"count\"))<limit)){_context.next=16;break;}// increment count value of local storage ( count is number of redirections to loginpage )\nlocalStorage.setItem(\"count\",\"\".concat(parseInt(localStorage.getItem(\"count\"))+1));// before redirecton checks if the login page is up else redirects to down page\n_context.next=12;return getStatus(\"https://login-three-gamma.vercel.app/\");case 12:isUp=_context.sent;if(isUp){redirect(\"https://login-three-gamma.vercel.app/cookie/\".concat(window.location.host));}else{redirect(\"https://\".concat(window.location.host,\"/down\"));}_context.next=17;break;case 16:if(parseInt(localStorage.getItem(\"count\"))>=3){localStorage.setItem(\"count\",\"\".concat(0));redirect(\"https://\".concat(window.location.host,\"/error\"));}case 17:case\"end\":return _context.stop();}}},_callee);})),[]);return/*#__PURE__*/_jsx(\"div\",{className:\"center\",children:/*#__PURE__*/_jsxs(\"header\",{className:\"App-header\",children:[\"Token is \",token]})});}export default App;","map":{"version":3,"names":["useEffect","useState","useParams","axios","App","id","token","setToken","limit","localStorage","getItem","setItem","getStatus","url","get","then","response","status","data","catch","error","a","redirect","window","location","replace","document","cookie","console","log","host","parseInt","isUp"],"sources":["/Users/g.anirudh/Desktop/POC/food-app/src/components/app/App.js"],"sourcesContent":["import './App.css';\nimport { useEffect, useState } from \"react\"\nimport { useParams } from \"react-router-dom\";\nimport axios from \"axios\";\nfunction App() {\n  let { id } = useParams();\n  const [token, setToken] = useState(\"\");\n  const limit = 3;\n\n  if(localStorage.getItem(\"count\")===null){\n    localStorage.setItem(\"count\",'0');\n  }\n\n  // getStaus function returns promise with true or false based on page up\n  async function  getStatus (url)  {\n    let a = await axios.get(url)\n            .then((response) => {\n              if(response.status === 200){\n                return true\n            }\n            else{\n              return false\n            }\n          }).then(data=>data)\n            .catch((error)=>{\n              return false\n            })\n    return a;\n  }\n\n  // function to redirect\n  const redirect = url => {\n    window.location.replace(url);\n  }\n\n  // UseEffect Function\n  useEffect(async ()  => {\n    // enters if we get token\n    if (typeof (id) !== 'undefined' && id !== null && id !== \"\" ) {\n      document.cookie = id;\n      setToken(id);\n      console.log(token);\n      localStorage.setItem(\"count\",`${0}`);\n      console.log(window.location.host)\n      // redirect(`https://${window.location.host}/success`)\n    } \n    else {\n      // if count is less than 3 try to redirect to login else redirect to error page\n      if(parseInt(localStorage.getItem(\"count\"))<limit){\n        // increment count value of local storage ( count is number of redirections to loginpage )\n        localStorage.setItem(\"count\",`${parseInt(localStorage.getItem(\"count\"))+1}`)\n        // before redirecton checks if the login page is up else redirects to down page\n        let isUp = await getStatus(\"https://login-three-gamma.vercel.app/\");\n        if(isUp){\n          redirect(`https://login-three-gamma.vercel.app/cookie/${window.location.host}`);\n        }else{\n          redirect(`https://${window.location.host}/down`)\n        }\n      }\n      else if(parseInt(localStorage.getItem(\"count\"))>=3){\n        localStorage.setItem(\"count\",`${0}`);\n        redirect(`https://${window.location.host}/error`)\n      }\n\n    }\n  }, [])\n\n  return (\n    <div className=\"center\">\n      <header className=\"App-header\">\n        {\"Token is \"}\n        {token}\n      </header>\n    </div>\n  );\n\n}\n\nexport default App;\n"],"mappings":"iYAAA,MAAO,WAAP,CACA,OAASA,SAAT,CAAoBC,QAApB,KAAoC,OAApC,CACA,OAASC,SAAT,KAA0B,kBAA1B,CACA,MAAOC,MAAP,KAAkB,OAAlB,C,wFACA,QAASC,IAAT,EAAe,CACb,eAAaF,SAAS,EAAtB,CAAMG,EAAN,YAAMA,EAAN,CACA,cAA0BJ,QAAQ,CAAC,EAAD,CAAlC,wCAAOK,KAAP,eAAcC,QAAd,eACA,GAAMC,MAAK,CAAG,CAAd,CAEA,GAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,IAAgC,IAAnC,CAAwC,CACtCD,YAAY,CAACE,OAAb,CAAqB,OAArB,CAA6B,GAA7B,EACD,CAED;AATa,QAUGC,UAVH,8CA0Bb;AA1Ba,2FAUb,kBAA2BC,GAA3B,qJACgBV,MAAK,CAACW,GAAN,CAAUD,GAAV,EACLE,IADK,CACA,SAACC,QAAD,CAAc,CAClB,GAAGA,QAAQ,CAACC,MAAT,GAAoB,GAAvB,CAA2B,CACzB,MAAO,KAAP,CACH,CAFC,IAGE,CACF,MAAO,MAAP,CACD,CACF,CARO,EAQLF,IARK,CAQA,SAAAG,IAAI,QAAEA,KAAF,EARJ,EASLC,KATK,CASC,SAACC,KAAD,CAAS,CACd,MAAO,MAAP,CACD,CAXK,CADhB,QACMC,CADN,iDAaSA,CAbT,0DAVa,4CA2Bb,GAAMC,SAAQ,CAAG,QAAXA,SAAW,CAAAT,GAAG,CAAI,CACtBU,MAAM,CAACC,QAAP,CAAgBC,OAAhB,CAAwBZ,GAAxB,EACD,CAFD,CAIA;AACAb,SAAS,wEAAC,mJAEJ,MAAQK,GAAR,GAAgB,WAAhB,EAA+BA,EAAE,GAAK,IAAtC,EAA8CA,EAAE,GAAK,EAFjD,0BAGNqB,QAAQ,CAACC,MAAT,CAAkBtB,EAAlB,CACAE,QAAQ,CAACF,EAAD,CAAR,CACAuB,OAAO,CAACC,GAAR,CAAYvB,KAAZ,EACAG,YAAY,CAACE,OAAb,CAAqB,OAArB,WAAgC,CAAhC,GACAiB,OAAO,CAACC,GAAR,CAAYN,MAAM,CAACC,QAAP,CAAgBM,IAA5B,EACA;AARM,mCAYHC,QAAQ,CAACtB,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAD,CAAR,CAAwCF,KAZrC,2BAaJ;AACAC,YAAY,CAACE,OAAb,CAAqB,OAArB,WAAgCoB,QAAQ,CAACtB,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAD,CAAR,CAAwC,CAAxE,GACA;AAfI,uBAgBaE,UAAS,CAAC,uCAAD,CAhBtB,SAgBAoB,IAhBA,eAiBJ,GAAGA,IAAH,CAAQ,CACNV,QAAQ,uDAAgDC,MAAM,CAACC,QAAP,CAAgBM,IAAhE,EAAR,CACD,CAFD,IAEK,CACHR,QAAQ,mBAAYC,MAAM,CAACC,QAAP,CAAgBM,IAA5B,UAAR,CACD,CArBG,+BAuBD,GAAGC,QAAQ,CAACtB,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAD,CAAR,EAAyC,CAA5C,CAA8C,CACjDD,YAAY,CAACE,OAAb,CAAqB,OAArB,WAAgC,CAAhC,GACAW,QAAQ,mBAAYC,MAAM,CAACC,QAAP,CAAgBM,IAA5B,WAAR,CACD,CA1BK,uDAAD,GA6BN,EA7BM,CAAT,CA+BA,mBACE,YAAK,SAAS,CAAC,QAAf,uBACE,gBAAQ,SAAS,CAAC,YAAlB,WACG,WADH,CAEGxB,KAFH,GADF,EADF,CASD,CAED,cAAeF,IAAf"},"metadata":{},"sourceType":"module"}